@model IEnumerable<CompanyProject.Data.Models.EmployeeLeave>

<h2>Leave requests & history</h2>
<a class="btn btn-dark mb-3" asp-action="AddLeave">Request leave</a>
<table class="table">
    <thead><tr><th>Description</th><th>Type</th><th>Start</th><th>End</th><th>Status</th><th>Comments</th></tr></thead>
    <tbody>
    @foreach (var item in Model)
    {
        <tr>
            <td>@item.LeaveDescription</td>
            <td>@item.LeaveType?.Name</td>
            <td>@item.LeaveStart</td>
            <td>@item.LeaveEnd</td>
            <td>@item.ApprovalStatus</td>
            <td>
                <ul>
                    @foreach (var c in item.Comments.OrderByDescending(x => x.CreatedAt))
                    {
                        <li>@c.Comment (@c.CreatedAt.ToLocalTime())</li>
                    }
                </ul>
                <form asp-action="AddComment" method="post" class="d-flex gap-2">
                    <input type="hidden" name="id" value="@item.Id" />
                    <input class="form-control" name="comment" placeholder="Add comment" />
                    <button class="btn btn-sm btn-outline-secondary">Save</button>
                </form>
            </td>
        </tr>
    }
    </tbody>
</table>
